# 理财性格测试小游戏交易策略

游戏位置：支付宝 -> 我的 -> 总资产 -> 我的档案

项目使用vue3 + vite构建，可在本地运行，输入每次的涨跌幅数据便可自动化给出策略中的决策建议

## 使用方式

1. clone项目
```
git clone https://github.com/lizhink/alipay-game-trading
```
2. 在目录下安装环境依赖
```
npm install
```
3. 运行项目，打开本地代理地址使用
```
npm run dev
```

## 游戏规则
- 10000元初始资金
- 除了初始只能选择买入，后面有10步操作机会，每步可以选择买入、卖出、持有不动
- 后10次选择前会额外收到1000元
- 买入、卖出基础单位为总金额的1%

## 现实情况
- 若初始投入为1%，往后每一步都选择持有不动，最高确定收益有 `(10000 * 0.99) + 1000 * 10 = 19900`，加上第一步投资金额 `100` 元，总本金 `20000` 元
- 每步对投资市场涨跌可观察的变量为：较上一次行情跌幅

## 策略思考

从现实情况来看，若10次投资后总资产低于本金20000，则投资结果上来说是失败的。从市场涨跌可观察的维度来看，只能单一从历史跌幅单维度来观察。

正因为是单维的角度，没法参考别的相关联系的信息进行参照，所以可供建立的模型有限。目前决定先做一套简单的算法，日后有更好的知识体系支撑的时候再加入新的算法。

## 所有决策选择：
### 初始投资可做出的决策
```
[买入1%, 买入2%，买入3% …… 买入100%]

合计 100 种决策
```
### 余下10次里面每一次可做出的决策
```
[买入1%, 买入2%，买入3% …… 买入100%]

[卖出1%, 卖出2%，卖出3% …… 卖出100%]

[不作操作(买入0%)]

合计 201 种决策
```


## 算法一：
### 策略目标：
```
最大化盈利概率，进而最大化盈利次数
```

### 判断逻辑：
```
if (在最大跌幅预期下存在保本选择:算法a) {
    选择最大化预期收益的选择:算法b
} else {
    if (平均涨跌幅:算法c > 0) {
        把买入的仓位调整到在预期平均涨跌幅的情况下最接近可以回本的比例:算法d
    } else {
        [这种情况代表着历史趋势是往下走的，考虑到目的是最大化盈利概率而不是最大化盈利，所以暂时设定为保持不动]
    }
}
```
```
预期最大跌幅：k
```
算法a：**寻找即使经历最大预期跌幅，总金额价值也能大于本金的选择**

*"目前知识储备量还不知道用什么概率统计公式得出预期值比较好，正在学习相关的统计概率学知识，等到知道用什么公式的时候更新把公式用上，根据过往的游戏经验（看上去可能与贝叶斯方法相关），暂时把预期最大跌幅取值为-0.35(-35%)"*

```
经历最大预期跌幅后的总金额 - 投资本金 > 0 
```
```
买入决策：
0 < (可买金额c - 可买金额c * 买入比例e) + (可卖金额d + 可买金额c * 买入比例e) * 预期最大跌幅k - 投资本金b

卖出决策：
0 < (可买金额c + 可卖金额d * 卖出比例e) + (可卖金额d - 可卖金额d * 卖出比例e) * 预期最大跌幅k - 投资本金b

不操作的决策：
0 < 可买金额c + 可卖金额d * 预期最大跌幅k - 投资本金b
```
```
买入决策：
0 < (c - c * e) + (d + c * e) * k - b
求买入比例e的区间
e > (b - c - d * k) / (c + d * k)

卖出决策：
0 < (c + d * e) + (d - d * e) * k - b
求卖出比例e的区间
e > (b - c - d * k) / (d - d * k)

不操作的决策：
0 < c + d * k - b
```

算法b：**在满足判断一的前提下，寻找最大化潜在收益的决策**

投资的仓位越大，潜在收益越大。所以优先寻找在满足判断一的前提下投资仓位（可卖金额）最大的选项。

算法c：**平均涨跌幅**
```
平均涨跌幅 = 历史涨跌幅之和 / 总数
```

算法d: **把买入的仓位调整到在预期平均涨跌幅的情况下最接近回本的比例**
```
本金亏损绝对值a = 可卖金额b * (1 + 调整比例c) * 平均涨跌幅d - 可卖金额b * (1 + 调整比例c)

a = b * (1 + c) * d - b * (1 + c)
c = (a / b - d + 1) / (d - 1)
```

### 策略思考：
```
这个算法的核心逻辑是：即使经历最大预期跌幅，总金额价值也能大于本金，以此来达成最大化盈利次数的效果。
就算是没办法有保本的决策，也尽可能的保持最大化保本的概率。

缺点也很明显，以保本放在首位，预期风险和收益也会相应降低。
```

## 算法二：
### 策略目标
```
寻找最小盈利预期
```

### 策略逻辑
计算做出决策后下一次行情涨跌幅达到多少百分比(f)才能盈利:
```
本金差值a = 投资本金b - (可买金额c + 可卖金额d)

买入决策：
本金差值a < (可买金额c - 可买金额c * 买入比例e) + (可卖金额d + 可买金额c * 买入比例e) * 预期涨跌幅f - 投资本金b

卖出决策：
本金差值a < (可买金额c + 可卖金额d * 卖出比例e) + (可卖金额d - 可卖金额d * 卖出比例e) * 预期涨跌幅f - 投资本金b

不操作的决策：
本金差值a < 可买金额c + 可卖金额d * 预期涨跌幅f - 投资本金b
```

即

```
买入决策：
a < (c - c * e ) + (d + c * e) * f - b

卖出决策：
a < (c + d * e ) + (d - d * e) * f - b

不操作的决策：
a < c + d * f - b
```

换算求预期涨跌幅 f
```
买入决策：
f > (a - c + c * e + b) / (d + c * e)

卖出决策：
f > (a - c - d * e + b) / (d - d * e)

不操作的决策：
f > (a - c + b) / d
```

> 计算出来的 f 值越低，即1-f的值越大，说明达到盈利的需要涨幅越小，越容易实现。

### 策略思考：
```
这个算法的核心逻辑是：计算盈利目标容不容易达到，用来量化对比成功盈利的概率。

缺点就是若一味最求更高的成功盈利概率，结果会偏向于大的仓位，此时的风险也会随之增高。
```